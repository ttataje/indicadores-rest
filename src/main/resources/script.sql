CREATE TABLE INDICADOR (
  CODIGO INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  DESCRIPCION VARCHAR(500) NULL,
  POSITION INTEGER UNSIGNED NULL,
  PADRE INTEGER UNSIGNED NULL,
  TIPO VARCHAR(20) NOT NULL DEFAULT 'folder',
  PUBLICO TINYINT(1) UNSIGNED DEFAULT 0,
  PRIMARY KEY(CODIGO),
  INDEX INDICADOR_PADRE_FK(PADRE),
  FOREIGN KEY(PADRE)
    REFERENCES INDICADOR(CODIGO)
      ON DELETE CASCADE
      ON UPDATE CASCADE
);

INSERT INTO INDICADOR (DESCRIPCION, TIPO, POSITION) VALUES ('Region Ica','root', 1);

CREATE TABLE GRAFICO (
  CODIGO INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  INDICADOR INTEGER UNSIGNED NOT NULL,
  TIPO VARCHAR(20) NOT NULL,
  PRIMARY KEY(CODIGO),
  INDEX GRAFICO_INDICADOR_FK(INDICADOR),
  FOREIGN KEY(INDICADOR)
    REFERENCES INDICADOR(CODIGO)
      ON DELETE CASCADE
      ON UPDATE CASCADE
);

CREATE TABLE DETALLE_GRAFICO (
  CODIGO INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  GRAFICO INTEGER UNSIGNED NULL COMMENT 'Codigo del grafico relacionado',
  DATA TEXT NULL,
  ATTRIBUTES TEXT NULL, 
  FOOTER TEXT NULL,
  PRIMARY KEY(CODIGO),
  INDEX DETALLE_GRAFICO_GRAFICO_FK(GRAFICO),
  FOREIGN KEY(GRAFICO)
    REFERENCES GRAFICO(CODIGO)
      ON DELETE CASCADE
      ON UPDATE CASCADE
);